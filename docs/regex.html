<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Regular expressions | Web Scraping using R</title>
  <meta name="description" content="13 Regular expressions | Web Scraping using R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Regular expressions | Web Scraping using R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="webscraping-tures/webscraping-tures.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Regular expressions | Web Scraping using R" />
  
  
  

<meta name="author" content="Jakob Tures" />


<meta name="date" content="2021-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ggplot.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/echarts4r-4.8.0/echarts-en.min.js"></script>
<script src="libs/echarts4r-4.8.0/ecStat.min.js"></script>
<script src="libs/echarts4r-4.8.0/dataTool.min.js"></script>
<script src="libs/echarts4r-binding-0.4.0/echarts4r.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
Web Scraping using R

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-web-scraping"><i class="fa fa-check"></i>What is web scraping?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-contents"><i class="fa fa-check"></i>Course contents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#technical-requirements"><i class="fa fa-check"></i>Technical requirements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Basics</b></span></li>
<li class="chapter" data-level="1" data-path="html.html"><a href="html.html"><i class="fa fa-check"></i><b>1</b> HTML as a cornerstone of the internet</a>
<ul>
<li class="chapter" data-level="1.1" data-path="html.html"><a href="html.html#html-tags"><i class="fa fa-check"></i><b>1.1</b> HTML-Tags</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="html.html"><a href="html.html#hello_world.html"><i class="fa fa-check"></i><b>1.1.1</b> hello_world.html</a></li>
<li class="chapter" data-level="1.1.2" data-path="html.html"><a href="html.html#important-tags"><i class="fa fa-check"></i><b>1.1.2</b> Important tags</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="html.html"><a href="html.html#attribute"><i class="fa fa-check"></i><b>1.2</b> Attributes</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="html.html"><a href="html.html#links"><i class="fa fa-check"></i><b>1.2.1</b> Links</a></li>
<li class="chapter" data-level="1.2.2" data-path="html.html"><a href="html.html#images"><i class="fa fa-check"></i><b>1.2.2</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="html.html"><a href="html.html#entities"><i class="fa fa-check"></i><b>1.3</b> Entities</a></li>
</ul></li>
<li class="part"><span><b>II R Basics &amp; Tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="R1.html"><a href="R1.html"><i class="fa fa-check"></i><b>2</b> R &amp; R Studio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="R1.html"><a href="R1.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing R</a></li>
<li class="chapter" data-level="2.2" data-path="R1.html"><a href="R1.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="R1.html"><a href="R1.html#overview"><i class="fa fa-check"></i><b>2.2.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="R1.html"><a href="R1.html#hello-world"><i class="fa fa-check"></i><b>2.3</b> Hello World!</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="R1.html"><a href="R1.html#calculating-with-r"><i class="fa fa-check"></i><b>2.3.1</b> Calculating with R</a></li>
<li class="chapter" data-level="2.3.2" data-path="R1.html"><a href="R1.html#comparison"><i class="fa fa-check"></i><b>2.3.2</b> Comparison operators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="R1.html"><a href="R1.html#objects"><i class="fa fa-check"></i><b>2.4</b> Objects</a></li>
<li class="chapter" data-level="2.5" data-path="R1.html"><a href="R1.html#vectors"><i class="fa fa-check"></i><b>2.5</b> Vectors</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="R1.html"><a href="R1.html#subsetting"><i class="fa fa-check"></i><b>2.5.1</b> Subsetting</a></li>
<li class="chapter" data-level="2.5.2" data-path="R1.html"><a href="R1.html#types-of-vectors"><i class="fa fa-check"></i><b>2.5.2</b> Types of vectors</a></li>
<li class="chapter" data-level="2.5.3" data-path="R1.html"><a href="R1.html#a-brief-look-at-lists"><i class="fa fa-check"></i><b>2.5.3</b> A brief look at lists</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="R1.html"><a href="R1.html#functions"><i class="fa fa-check"></i><b>2.6</b> Functions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="R1.html"><a href="R1.html#help"><i class="fa fa-check"></i><b>2.6.1</b> Help</a></li>
<li class="chapter" data-level="2.6.2" data-path="R1.html"><a href="R1.html#examples-basic-statistical-functions"><i class="fa fa-check"></i><b>2.6.2</b> Examples: Basic statistical functions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="R1.html"><a href="R1.html#ifelse-statements"><i class="fa fa-check"></i><b>2.7</b> If/Else statements</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R2.html"><a href="R2.html"><i class="fa fa-check"></i><b>3</b> RStudio in practice &amp; the tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="R2.html"><a href="R2.html#rstudio-workflow"><i class="fa fa-check"></i><b>3.1</b> RStudio Workflow</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="R2.html"><a href="R2.html#r-scripts"><i class="fa fa-check"></i><b>3.1.1</b> R Scripts</a></li>
<li class="chapter" data-level="3.1.2" data-path="R2.html"><a href="R2.html#projects"><i class="fa fa-check"></i><b>3.1.2</b> Projects</a></li>
<li class="chapter" data-level="3.1.3" data-path="R2.html"><a href="R2.html#comments"><i class="fa fa-check"></i><b>3.1.3</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R2.html"><a href="R2.html#r-packages"><i class="fa fa-check"></i><b>3.2</b> R packages</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="R2.html"><a href="R2.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>3.2.1</b> Installing and loading packages</a></li>
<li class="chapter" data-level="3.2.2" data-path="R2.html"><a href="R2.html#namespaces"><i class="fa fa-check"></i><b>3.2.2</b> Namespaces</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="R2.html"><a href="R2.html#tidyverse"><i class="fa fa-check"></i><b>3.3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="R2.html"><a href="R2.html#tibbles"><i class="fa fa-check"></i><b>3.3.1</b> Tibbles</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="R2.html"><a href="R2.html#additional-resources"><i class="fa fa-check"></i><b>3.4</b> Additional resources</a></li>
</ul></li>
<li class="part"><span><b>III Scraping</b></span></li>
<li class="chapter" data-level="4" data-path="rvest1.html"><a href="rvest1.html"><i class="fa fa-check"></i><b>4</b> First scraping with rvest</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rvest1.html"><a href="rvest1.html#the-rvest-package"><i class="fa fa-check"></i><b>4.1</b> The rvest package</a></li>
<li class="chapter" data-level="4.2" data-path="rvest1.html"><a href="rvest1.html#hello_world.html-1"><i class="fa fa-check"></i><b>4.2</b> hello_world.html</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rvest1.html"><a href="rvest1.html#read_html"><i class="fa fa-check"></i><b>4.2.1</b> read_html()</a></li>
<li class="chapter" data-level="4.2.2" data-path="rvest1.html"><a href="rvest1.html#html_nodes"><i class="fa fa-check"></i><b>4.2.2</b> html_nodes()</a></li>
<li class="chapter" data-level="4.2.3" data-path="rvest1.html"><a href="rvest1.html#html_text"><i class="fa fa-check"></i><b>4.2.3</b> html_text()</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rvest1.html"><a href="rvest1.html#countries-of-the-world"><i class="fa fa-check"></i><b>4.3</b> Countries of the World</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="rvest1.html"><a href="rvest1.html#country-names"><i class="fa fa-check"></i><b>4.3.1</b> Country names</a></li>
<li class="chapter" data-level="4.3.2" data-path="rvest1.html"><a href="rvest1.html#capitals-population-and-area"><i class="fa fa-check"></i><b>4.3.2</b> Capitals, population and area</a></li>
<li class="chapter" data-level="4.3.3" data-path="rvest1.html"><a href="rvest1.html#merge-into-one-tibble"><i class="fa fa-check"></i><b>4.3.3</b> Merge into one tibble</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html"><i class="fa fa-check"></i><b>5</b> CSS selectors &amp; Developer Tools</a>
<ul>
<li class="chapter" data-level="5.1" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#css"><i class="fa fa-check"></i><b>5.1</b> CSS selectors</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#classes"><i class="fa fa-check"></i><b>5.1.1</b> Classes</a></li>
<li class="chapter" data-level="5.1.2" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#ids"><i class="fa fa-check"></i><b>5.1.2</b> IDs</a></li>
<li class="chapter" data-level="5.1.3" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#attributes"><i class="fa fa-check"></i><b>5.1.3</b> Attributes</a></li>
<li class="chapter" data-level="5.1.4" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#hierarchy-levels"><i class="fa fa-check"></i><b>5.1.4</b> Hierarchy levels</a></li>
<li class="chapter" data-level="5.1.5" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#further-selectors"><i class="fa fa-check"></i><b>5.1.5</b> Further selectors</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="css-selectors-developer-tools.html"><a href="css-selectors-developer-tools.html#developer-tools"><i class="fa fa-check"></i><b>5.2</b> Developer Tools</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rvest2.html"><a href="rvest2.html"><i class="fa fa-check"></i><b>6</b> Scraping of tables &amp; dynamic websites</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rvest2.html"><a href="rvest2.html#scraping-of-tables"><i class="fa fa-check"></i><b>6.1</b> Scraping of tables</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="rvest2.html"><a href="rvest2.html#table-with-css-selectors-from-wikipedia"><i class="fa fa-check"></i><b>6.1.1</b> Table with CSS selectors from Wikipedia</a></li>
<li class="chapter" data-level="6.1.2" data-path="rvest2.html"><a href="rvest2.html#scraping-multiple-tables"><i class="fa fa-check"></i><b>6.1.2</b> Scraping multiple tables</a></li>
<li class="chapter" data-level="6.1.3" data-path="rvest2.html"><a href="rvest2.html#tabellen-mit-nas"><i class="fa fa-check"></i><b>6.1.3</b> Tabellen mit NAs</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="rvest2.html"><a href="rvest2.html#dynamische-websites"><i class="fa fa-check"></i><b>6.2</b> Dynamische Websites</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="rvest2.html"><a href="rvest2.html#html-forms-and-html-queries"><i class="fa fa-check"></i><b>6.2.1</b> HTML forms and HTML queries</a></li>
<li class="chapter" data-level="6.2.2" data-path="rvest2.html"><a href="rvest2.html#html-forms"><i class="fa fa-check"></i><b>6.2.2</b> HTML forms</a></li>
<li class="chapter" data-level="6.2.3" data-path="rvest2.html"><a href="rvest2.html#the-query"><i class="fa fa-check"></i><b>6.2.3</b> The query</a></li>
<li class="chapter" data-level="6.2.4" data-path="rvest2.html"><a href="rvest2.html#manipulating-the-query-and-scraping-the-result"><i class="fa fa-check"></i><b>6.2.4</b> Manipulating the query and scraping the result</a></li>
<li class="chapter" data-level="6.2.5" data-path="rvest2.html"><a href="rvest2.html#additional-resources-1"><i class="fa fa-check"></i><b>6.2.5</b> Additional resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rvest3.html"><a href="rvest3.html"><i class="fa fa-check"></i><b>7</b> Scraping of multi-page websites</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rvest3.html"><a href="rvest3.html#index-pages"><i class="fa fa-check"></i><b>7.1</b> Index-pages</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="rvest3.html"><a href="rvest3.html#scraping-of-the-index"><i class="fa fa-check"></i><b>7.1.1</b> Scraping of the index</a></li>
<li class="chapter" data-level="7.1.2" data-path="rvest3.html"><a href="rvest3.html#iteration-with-map"><i class="fa fa-check"></i><b>7.1.2</b> Iteration with map()</a></li>
<li class="chapter" data-level="7.1.3" data-path="rvest3.html"><a href="rvest3.html#scraping-the-sub-pages"><i class="fa fa-check"></i><b>7.1.3</b> Scraping the sub-pages</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rvest3.html"><a href="rvest3.html#pagination"><i class="fa fa-check"></i><b>7.2</b> Pagination</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="rvest3.html"><a href="rvest3.html#the-query-1"><i class="fa fa-check"></i><b>7.2.1</b> The query</a></li>
<li class="chapter" data-level="7.2.2" data-path="rvest3.html"><a href="rvest3.html#sub-pgs"><i class="fa fa-check"></i><b>7.2.2</b> Scraping the sub-pages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>8</b> Downloading and saving files</a>
<ul>
<li class="chapter" data-level="8.1" data-path="files.html"><a href="files.html#csv-files"><i class="fa fa-check"></i><b>8.1</b> CSV files</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="files.html"><a href="files.html#parsing-a-csv-file"><i class="fa fa-check"></i><b>8.1.1</b> Parsing a CSV file</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="files.html"><a href="files.html#downloading-files"><i class="fa fa-check"></i><b>8.2</b> Downloading files</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="files.html"><a href="files.html#parsing-the-csv-files"><i class="fa fa-check"></i><b>8.2.1</b> Parsing the csv files</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="files.html"><a href="files.html#saving-data-files"><i class="fa fa-check"></i><b>8.3</b> Saving data files</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="goodpractice.html"><a href="goodpractice.html"><i class="fa fa-check"></i><b>9</b> Good practice</a>
<ul>
<li class="chapter" data-level="9.1" data-path="goodpractice.html"><a href="goodpractice.html#we-aint-no-web-crawlers"><i class="fa fa-check"></i><b>9.1</b> We ain’t no web crawlers</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="goodpractice.html"><a href="goodpractice.html#on-robots.txt-files"><i class="fa fa-check"></i><b>9.1.1</b> On robots.txt files</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="goodpractice.html"><a href="goodpractice.html#reduce-traffic"><i class="fa fa-check"></i><b>9.2</b> Reduce traffic</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="goodpractice.html"><a href="goodpractice.html#waiting-times-in-action"><i class="fa fa-check"></i><b>9.2.1</b> Waiting times in action</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="goodpractice.html"><a href="goodpractice.html#citation-and-an-additional-resource"><i class="fa fa-check"></i><b>9.3</b> Citation and an additional resource</a></li>
</ul></li>
<li class="part"><span><b>IV Data analysis</b></span></li>
<li class="chapter" data-level="10" data-path="scraping.html"><a href="scraping.html"><i class="fa fa-check"></i><b>10</b> Scraping Berlin police reports</a>
<ul>
<li class="chapter" data-level="10.1" data-path="scraping.html"><a href="scraping.html#gathering-the-links"><i class="fa fa-check"></i><b>10.1</b> Gathering the links</a></li>
<li class="chapter" data-level="10.2" data-path="scraping.html"><a href="scraping.html#downloading-the-subpages"><i class="fa fa-check"></i><b>10.2</b> Downloading the subpages</a></li>
<li class="chapter" data-level="10.3" data-path="scraping.html"><a href="scraping.html#extracting-the-data-of-interest"><i class="fa fa-check"></i><b>10.3</b> Extracting the data of interest</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="scraping.html"><a href="scraping.html#dealing-with-missing-data-in-lists"><i class="fa fa-check"></i><b>10.3.1</b> Dealing with missing data in lists</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="scraping.html"><a href="scraping.html#saving-the-data"><i class="fa fa-check"></i><b>10.4</b> Saving the data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>11</b> Transformation with dplyr</a>
<ul>
<li class="chapter" data-level="11.1" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>11.1</b> <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="dplyr.html"><a href="dplyr.html#computing-new-variables-from-existing-ones"><i class="fa fa-check"></i><b>11.1.1</b> Computing new variables from existing ones</a></li>
<li class="chapter" data-level="11.1.2" data-path="dplyr.html"><a href="dplyr.html#cleaning-the-data-on-police-reports"><i class="fa fa-check"></i><b>11.1.2</b> Cleaning the data on police reports</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>11.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="11.3" data-path="dplyr.html"><a href="dplyr.html#rename"><i class="fa fa-check"></i><b>11.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="11.4" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>11.4</b> <code>filter()</code></a></li>
<li class="chapter" data-level="11.5" data-path="dplyr.html"><a href="dplyr.html#summarise-group_by"><i class="fa fa-check"></i><b>11.5</b> <code>summarise()</code> &amp; <code>group_by()</code></a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="dplyr.html"><a href="dplyr.html#number-of-reports-by-groups"><i class="fa fa-check"></i><b>11.5.1</b> Number of reports by groups</a></li>
<li class="chapter" data-level="11.5.2" data-path="dplyr.html"><a href="dplyr.html#summary-statistics-on-the-time"><i class="fa fa-check"></i><b>11.5.2</b> Summary statistics on the time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>12</b> Graphical analysis with ggplot</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ggplot.html"><a href="ggplot.html#ggplot2-syntax"><i class="fa fa-check"></i><b>12.1</b> ggplot2 syntax</a></li>
<li class="chapter" data-level="12.2" data-path="ggplot.html"><a href="ggplot.html#geoms-and-aesthetics"><i class="fa fa-check"></i><b>12.2</b> Geoms and aesthetics</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ggplot.html"><a href="ggplot.html#continuous-x-continuous-y"><i class="fa fa-check"></i><b>12.2.1</b> Continuous x, continuous y</a></li>
<li class="chapter" data-level="12.2.2" data-path="ggplot.html"><a href="ggplot.html#graphical-analysis-of-berlin-police-reports"><i class="fa fa-check"></i><b>12.2.2</b> Graphical analysis of Berlin police reports</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regex.html"><a href="regex.html"><i class="fa fa-check"></i><b>13</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="regex.html"><a href="regex.html#cleaning-the-district-column"><i class="fa fa-check"></i><b>13.1</b> Cleaning the <code>district</code> column</a></li>
<li class="chapter" data-level="13.2" data-path="regex.html"><a href="regex.html#detecting-and-counting-robberies-from-police-reports"><i class="fa fa-check"></i><b>13.2</b> Detecting and counting robberies from police reports</a></li>
<li class="chapter" data-level="13.3" data-path="regex.html"><a href="regex.html#parsing-two-numbers-from-a-string"><i class="fa fa-check"></i><b>13.3</b> Parsing two numbers from a string</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Web Scraping using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regex" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Regular expressions</h1>
<p>In Web Scraping, we are often dealing with textual data that has been collected
from a website and may include information that is not directly accessible and
usable in data analysis. We may be interested in counting the occurrence of
certain words or in extracting several numbers from the strings in our data. For
these purposes we will use some functions from the core tidyverse package
stringr. To find substrings that include the words or terms we are searching
for, we will use <em>regular expressions</em>, a powerful and flexible formal
representation of characters that are used to find and match patterns in
character data.</p>
<p>This chapter will make use of some practical examples, introducing the basics of
regular expressions and stringr. This can only be a starting point, if you want
to further follow the road of Web Scraping, you most probably will have to
further your knowledge on regular expressions at some point. A recommended next
step would be the chapter on string from “R for Data Science” by Wickham and
Grolemund:
<a href="https://r4ds.had.co.nz/strings.html" target="_blank">https://r4ds.had.co.nz/strings.html</a>, as well as the RStudio
CHeat Sheet on stringr:
<a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/strings.pdf" target="_blank">https://raw.githubusercontent.com/rstudio/cheatsheets/master/strings.pdf</a>.</p>
<div id="cleaning-the-district-column" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Cleaning the <code>district</code> column</h2>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="regex.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb228-2"><a href="regex.html#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="regex.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;reports.RData&quot;</span>)</span></code></pre></div>
<p>The data on police reports we used contains the district a report refers to as a
column which needs some cleaning to be usable.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="regex.html#cb229-1" aria-hidden="true" tabindex="-1"></a>reports <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="regex.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(District) <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="regex.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb229-4"><a href="regex.html#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 10 x 1</span></span>
<span id="cb229-5"><a href="regex.html#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    District                               </span></span>
<span id="cb229-6"><a href="regex.html#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;                                  </span></span>
<span id="cb229-7"><a href="regex.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Ereignisort: Treptow-Köpenick          </span></span>
<span id="cb229-8"><a href="regex.html#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Ereignisort: Tempelhof-Schöneberg      </span></span>
<span id="cb229-9"><a href="regex.html#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Ereignisort: bezirksübergreifend       </span></span>
<span id="cb229-10"><a href="regex.html#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Ereignisort: bezirksübergreifend       </span></span>
<span id="cb229-11"><a href="regex.html#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Ereignisort: Tempelhof-Schöneberg      </span></span>
<span id="cb229-12"><a href="regex.html#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Ereignisort: Friedrichshain-Kreuzberg  </span></span>
<span id="cb229-13"><a href="regex.html#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Ereignisort: Steglitz-Zehlendorf       </span></span>
<span id="cb229-14"><a href="regex.html#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Ereignisort: Charlottenburg-Wilmersdorf</span></span>
<span id="cb229-15"><a href="regex.html#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Ereignisort: Marzahn-Hellersdorf       </span></span>
<span id="cb229-16"><a href="regex.html#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Ereignisort: Charlottenburg-Wilmersdorf</span></span></code></pre></div>
<p>The first problem is, that each string begins with “Ereignisort:”. We may want
to get rid of this substring, as it does not contain any useful information.
<code>str_remove()</code> does what the name implies, in that it removes substrings from a
string. Like all stringr functions we will use here, <code>str_remove()</code> takes the
string(s) to be applied to as its first argument as well as the argument
<code>pattern =</code> to specify a regular expressions for the pattern that is to be
matched and removed. In the code block below, the strings are passed through the
pipe and the most basic form of a regular expression is used, the exact matching
of characters, here <code>"Ereignisort: "</code>. In general, the complete regular
expression is enclosed by <code>"</code>.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="regex.html#cb230-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>District <span class="sc">%&gt;%</span> </span>
<span id="cb230-2"><a href="regex.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="at">pattern =</span> <span class="st">&quot;Ereignisort: &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb230-3"><a href="regex.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb230-4"><a href="regex.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;Treptow-Köpenick&quot;           &quot;Tempelhof-Schöneberg&quot;      </span></span>
<span id="cb230-5"><a href="regex.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  [3] &quot;bezirksübergreifend&quot;        &quot;bezirksübergreifend&quot;       </span></span>
<span id="cb230-6"><a href="regex.html#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] &quot;Tempelhof-Schöneberg&quot;       &quot;Friedrichshain-Kreuzberg&quot;  </span></span>
<span id="cb230-7"><a href="regex.html#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] &quot;Steglitz-Zehlendorf&quot;        &quot;Charlottenburg-Wilmersdorf&quot;</span></span>
<span id="cb230-8"><a href="regex.html#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;Marzahn-Hellersdorf&quot;        &quot;Charlottenburg-Wilmersdorf&quot;</span></span></code></pre></div>
<p>Maybe we want to keep the substring but translate it to English. For this, we
can use <code>str_replace()</code> which also matches a regular expression, but replaces
it with a string specified in <code>replacement =</code>. Here, the pattern is shortened to
<code>"Ereignisort"</code>, as we want to keep the <code>": "</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="regex.html#cb231-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>District <span class="sc">%&gt;%</span> </span>
<span id="cb231-2"><a href="regex.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="at">pattern =</span> <span class="st">&quot;Ereignisort&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;District&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb231-3"><a href="regex.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb231-4"><a href="regex.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;District: Treptow-Köpenick&quot;          </span></span>
<span id="cb231-5"><a href="regex.html#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  [2] &quot;District: Tempelhof-Schöneberg&quot;      </span></span>
<span id="cb231-6"><a href="regex.html#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [3] &quot;District: bezirksübergreifend&quot;       </span></span>
<span id="cb231-7"><a href="regex.html#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [4] &quot;District: bezirksübergreifend&quot;       </span></span>
<span id="cb231-8"><a href="regex.html#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] &quot;District: Tempelhof-Schöneberg&quot;      </span></span>
<span id="cb231-9"><a href="regex.html#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [6] &quot;District: Friedrichshain-Kreuzberg&quot;  </span></span>
<span id="cb231-10"><a href="regex.html#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] &quot;District: Steglitz-Zehlendorf&quot;       </span></span>
<span id="cb231-11"><a href="regex.html#cb231-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] &quot;District: Charlottenburg-Wilmersdorf&quot;</span></span>
<span id="cb231-12"><a href="regex.html#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;District: Marzahn-Hellersdorf&quot;       </span></span>
<span id="cb231-13"><a href="regex.html#cb231-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [10] &quot;District: Charlottenburg-Wilmersdorf&quot;</span></span></code></pre></div>
<p>In the same way, we could replace the <code>": "</code> substring with an underscore.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="regex.html#cb232-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>District <span class="sc">%&gt;%</span> </span>
<span id="cb232-2"><a href="regex.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="at">pattern =</span> <span class="st">&quot;: &quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-3"><a href="regex.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb232-4"><a href="regex.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] &quot;Ereignisort_Treptow-Köpenick&quot;          </span></span>
<span id="cb232-5"><a href="regex.html#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  [2] &quot;Ereignisort_Tempelhof-Schöneberg&quot;      </span></span>
<span id="cb232-6"><a href="regex.html#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [3] &quot;Ereignisort_bezirksübergreifend&quot;       </span></span>
<span id="cb232-7"><a href="regex.html#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [4] &quot;Ereignisort_bezirksübergreifend&quot;       </span></span>
<span id="cb232-8"><a href="regex.html#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] &quot;Ereignisort_Tempelhof-Schöneberg&quot;      </span></span>
<span id="cb232-9"><a href="regex.html#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [6] &quot;Ereignisort_Friedrichshain-Kreuzberg&quot;  </span></span>
<span id="cb232-10"><a href="regex.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] &quot;Ereignisort_Steglitz-Zehlendorf&quot;       </span></span>
<span id="cb232-11"><a href="regex.html#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] &quot;Ereignisort_Charlottenburg-Wilmersdorf&quot;</span></span>
<span id="cb232-12"><a href="regex.html#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] &quot;Ereignisort_Marzahn-Hellersdorf&quot;       </span></span>
<span id="cb232-13"><a href="regex.html#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [10] &quot;Ereignisort_Charlottenburg-Wilmersdorf&quot;</span></span></code></pre></div>
<p>As seen in chapter <a href="dplyr.html#dplyr">11</a>, district names with two parts, are sometimes written with and
sometimes without whitespace around the dash, as seen here:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="regex.html#cb233-1" aria-hidden="true" tabindex="-1"></a>reports <span class="sc">%&gt;%</span> </span>
<span id="cb233-2"><a href="regex.html#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">%&gt;%</span> </span>
<span id="cb233-3"><a href="regex.html#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reports =</span> <span class="fu">n</span>())</span>
<span id="cb233-4"><a href="regex.html#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 22 x 2</span></span>
<span id="cb233-5"><a href="regex.html#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    District                                  reports</span></span>
<span id="cb233-6"><a href="regex.html#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  * &lt;chr&gt;                                       &lt;int&gt;</span></span>
<span id="cb233-7"><a href="regex.html#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Ereignisort: berlinweit                       252</span></span>
<span id="cb233-8"><a href="regex.html#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Ereignisort: bezirksübergreifend              775</span></span>
<span id="cb233-9"><a href="regex.html#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Ereignisort: bundesweit                        39</span></span>
<span id="cb233-10"><a href="regex.html#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Ereignisort: Charlottenburg - Wilmersdorf     580</span></span>
<span id="cb233-11"><a href="regex.html#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Ereignisort: Charlottenburg-Wilmersdorf       980</span></span>
<span id="cb233-12"><a href="regex.html#cb233-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Ereignisort: Friedrichshain - Kreuzberg       661</span></span>
<span id="cb233-13"><a href="regex.html#cb233-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Ereignisort: Friedrichshain-Kreuzberg        1170</span></span>
<span id="cb233-14"><a href="regex.html#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Ereignisort: Lichtenberg                      890</span></span>
<span id="cb233-15"><a href="regex.html#cb233-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Ereignisort: Marzahn - Hellersdorf            253</span></span>
<span id="cb233-16"><a href="regex.html#cb233-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Ereignisort: Marzahn-Hellersdorf              560</span></span>
<span id="cb233-17"><a href="regex.html#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 12 more rows</span></span></code></pre></div>
<p>We can easily unify those names using <code>str_replace</code> and regular expressions.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="regex.html#cb234-1" aria-hidden="true" tabindex="-1"></a>reports <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="regex.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District =</span> <span class="fu">str_replace</span>(District, <span class="at">pattern =</span> <span class="st">&quot; - &quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb234-3"><a href="regex.html#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">%&gt;%</span> </span>
<span id="cb234-4"><a href="regex.html#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reports =</span> <span class="fu">n</span>())</span>
<span id="cb234-5"><a href="regex.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 16 x 2</span></span>
<span id="cb234-6"><a href="regex.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    District                                reports</span></span>
<span id="cb234-7"><a href="regex.html#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  * &lt;chr&gt;                                     &lt;int&gt;</span></span>
<span id="cb234-8"><a href="regex.html#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Ereignisort: berlinweit                     252</span></span>
<span id="cb234-9"><a href="regex.html#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Ereignisort: bezirksübergreifend            775</span></span>
<span id="cb234-10"><a href="regex.html#cb234-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Ereignisort: bundesweit                      39</span></span>
<span id="cb234-11"><a href="regex.html#cb234-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Ereignisort: Charlottenburg-Wilmersdorf    1560</span></span>
<span id="cb234-12"><a href="regex.html#cb234-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Ereignisort: Friedrichshain-Kreuzberg      1831</span></span>
<span id="cb234-13"><a href="regex.html#cb234-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Ereignisort: Lichtenberg                    890</span></span>
<span id="cb234-14"><a href="regex.html#cb234-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Ereignisort: Marzahn-Hellersdorf            813</span></span>
<span id="cb234-15"><a href="regex.html#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Ereignisort: Mitte                         2557</span></span>
<span id="cb234-16"><a href="regex.html#cb234-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Ereignisort: Neukölln                      1468</span></span>
<span id="cb234-17"><a href="regex.html#cb234-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Ereignisort: Pankow                        1245</span></span>
<span id="cb234-18"><a href="regex.html#cb234-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 11 Ereignisort: Reinickendorf                  898</span></span>
<span id="cb234-19"><a href="regex.html#cb234-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 Ereignisort: Spandau                        835</span></span>
<span id="cb234-20"><a href="regex.html#cb234-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 13 Ereignisort: Steglitz-Zehlendorf            790</span></span>
<span id="cb234-21"><a href="regex.html#cb234-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 14 Ereignisort: Tempelhof-Schöneberg          1345</span></span>
<span id="cb234-22"><a href="regex.html#cb234-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 15 Ereignisort: Treptow-Köpenick              1014</span></span>
<span id="cb234-23"><a href="regex.html#cb234-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 16 &lt;NA&gt;                                        395</span></span></code></pre></div>
<p>If all we want is to remove the whitespace, unifying the names in the process,
we can use <code>str_remove()</code> and the regular expression <code>"\s"</code>, being a shortcut
for selecting all kinds of whitespace.</p>
<p>At this point we have to talk about escaping characters. Some characters used in
regular expressions have a special meaning, e.g. <code>"."</code>, <code>"?"</code> or <code>"\"</code>. If we
just write one of those characters in a regular expression, R will not take it
as a literal character but understand it by its special meaning. <code>"."</code> used in a
regular expression stands for all characters, meaning the expression will select
the complete string. If we want to match a literal <code>.</code> in a string though, we
have to escape the dot by using the <em>escape character</em> <code>\</code>. So to match a dot,
we write <code>"\."</code>. The <code>\</code> tells R to take the next character literally instead of
using its special meaning.</p>
<p><code>"\s"</code> begins with a backslash. In this case we have to tell R to take this
backslash literally by adding another backslash before it, escaping the second
backslash; <code>"\\s"</code> is understood as <code>"\s"</code>. If this seems confusing and
needlessly complicated, save your rage for when you find out what you have to
write to match a literal backslash in a string. For a full list of characters
that have to be escaped and how to escapte them, see the cheat sheet linked
above.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="regex.html#cb235-1" aria-hidden="true" tabindex="-1"></a>reports <span class="sc">%&gt;%</span></span>
<span id="cb235-2"><a href="regex.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District =</span> <span class="fu">str_remove</span>(District, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb235-3"><a href="regex.html#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">%&gt;%</span> </span>
<span id="cb235-4"><a href="regex.html#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reports =</span> <span class="fu">n</span>())</span>
<span id="cb235-5"><a href="regex.html#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 22 x 2</span></span>
<span id="cb235-6"><a href="regex.html#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    District                                 reports</span></span>
<span id="cb235-7"><a href="regex.html#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  * &lt;chr&gt;                                      &lt;int&gt;</span></span>
<span id="cb235-8"><a href="regex.html#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Ereignisort:berlinweit                       252</span></span>
<span id="cb235-9"><a href="regex.html#cb235-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Ereignisort:bezirksübergreifend              775</span></span>
<span id="cb235-10"><a href="regex.html#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Ereignisort:bundesweit                        39</span></span>
<span id="cb235-11"><a href="regex.html#cb235-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Ereignisort:Charlottenburg - Wilmersdorf     580</span></span>
<span id="cb235-12"><a href="regex.html#cb235-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Ereignisort:Charlottenburg-Wilmersdorf       980</span></span>
<span id="cb235-13"><a href="regex.html#cb235-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Ereignisort:Friedrichshain - Kreuzberg       661</span></span>
<span id="cb235-14"><a href="regex.html#cb235-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Ereignisort:Friedrichshain-Kreuzberg        1170</span></span>
<span id="cb235-15"><a href="regex.html#cb235-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Ereignisort:Lichtenberg                      890</span></span>
<span id="cb235-16"><a href="regex.html#cb235-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Ereignisort:Marzahn - Hellersdorf            253</span></span>
<span id="cb235-17"><a href="regex.html#cb235-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Ereignisort:Marzahn-Hellersdorf              560</span></span>
<span id="cb235-18"><a href="regex.html#cb235-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 12 more rows</span></span></code></pre></div>
<p>This did not work as expected. The whitespace following the <code>":"</code> was removed,
but not the whitespace around the dashes. This is the case, because most of the
stringr functions stop after they found the first match for the pattern in a
string. This is faster than always scanning the whole string, which is all the
more relevant as operations on strings and pattern matching are computationally
taxing. But there are versions of the functions, that do not stop after their
first match, ending in <code>_all</code>, e.g. <code>str_replace_all()</code>. So if we use
<code>str_remove_all()</code> in our code, all occurrences of whitespace will be removed.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="regex.html#cb236-1" aria-hidden="true" tabindex="-1"></a>reports <span class="sc">%&gt;%</span></span>
<span id="cb236-2"><a href="regex.html#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District =</span> <span class="fu">str_remove_all</span>(District, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb236-3"><a href="regex.html#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">%&gt;%</span> </span>
<span id="cb236-4"><a href="regex.html#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reports =</span> <span class="fu">n</span>())</span>
<span id="cb236-5"><a href="regex.html#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 16 x 2</span></span>
<span id="cb236-6"><a href="regex.html#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    District                               reports</span></span>
<span id="cb236-7"><a href="regex.html#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  * &lt;chr&gt;                                    &lt;int&gt;</span></span>
<span id="cb236-8"><a href="regex.html#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Ereignisort:berlinweit                     252</span></span>
<span id="cb236-9"><a href="regex.html#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Ereignisort:bezirksübergreifend            775</span></span>
<span id="cb236-10"><a href="regex.html#cb236-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Ereignisort:bundesweit                      39</span></span>
<span id="cb236-11"><a href="regex.html#cb236-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Ereignisort:Charlottenburg-Wilmersdorf    1560</span></span>
<span id="cb236-12"><a href="regex.html#cb236-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Ereignisort:Friedrichshain-Kreuzberg      1831</span></span>
<span id="cb236-13"><a href="regex.html#cb236-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Ereignisort:Lichtenberg                    890</span></span>
<span id="cb236-14"><a href="regex.html#cb236-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Ereignisort:Marzahn-Hellersdorf            813</span></span>
<span id="cb236-15"><a href="regex.html#cb236-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Ereignisort:Mitte                         2557</span></span>
<span id="cb236-16"><a href="regex.html#cb236-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Ereignisort:Neukölln                      1468</span></span>
<span id="cb236-17"><a href="regex.html#cb236-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Ereignisort:Pankow                        1245</span></span>
<span id="cb236-18"><a href="regex.html#cb236-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 11 Ereignisort:Reinickendorf                  898</span></span>
<span id="cb236-19"><a href="regex.html#cb236-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 Ereignisort:Spandau                        835</span></span>
<span id="cb236-20"><a href="regex.html#cb236-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 13 Ereignisort:Steglitz-Zehlendorf            790</span></span>
<span id="cb236-21"><a href="regex.html#cb236-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 14 Ereignisort:Tempelhof-Schöneberg          1345</span></span>
<span id="cb236-22"><a href="regex.html#cb236-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 15 Ereignisort:Treptow-Köpenick              1014</span></span>
<span id="cb236-23"><a href="regex.html#cb236-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 16 &lt;NA&gt;                                       395</span></span></code></pre></div>
</div>
<div id="detecting-and-counting-robberies-from-police-reports" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Detecting and counting robberies from police reports</h2>
<p>When collecting the data on police reports, we also scraped the short
description of the report’s contents but did no analysis on these in chapters
<a href="dplyr.html#dplyr">11</a> &amp; <a href="ggplot.html#ggplot">12</a>. We could try to catégorize the texts into types of
crimes using regular expressions. Doing this proper, would require a lot of
planning. We would have to decide which categories of crimes we want to extract
and construct flexible regular expressions for all of these. Please understand
the following only as a first outline for how to approach such a project.</p>
<p>Let us focus on robberies. As a first step, we can try to find all texts, that
contain the term “raub” in some form. <code>str_detect()</code> determines, if a pattern
was found in a string, returning <code>TRUE</code>or <code>FALSE</code>. We can than count the number
of strings for which the result is <code>TRUE</code>– remember <code>TRUE</code>is equal to <span class="math inline">\(1\)</span>,
<code>FALSE</code> equal to <span class="math inline">\(0\)</span> – using <code>sum()</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="regex.html#cb237-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>Report <span class="sc">%&gt;%</span> </span>
<span id="cb237-2"><a href="regex.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_detect</span>(<span class="at">pattern =</span> <span class="st">&quot;raub&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="regex.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb237-4"><a href="regex.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 424</span></span></code></pre></div>
<p>But what if a text beginns with “Raub”. In this case the “R” will be upper case.
Pattern matching is case sensitive and this means that “Raub” is not equal to
“raub”. If we want both ways of writing the term to be counted as equal, we have
to write a regular expression that allows for an upper or lower case r as the
first character. For this we can define a character class which contains both
characters. Character classes are enclosed by <code>[]</code>; <code>"[Rr]aub"</code> meaning that we
want to find either an “R” or an “r” as the first character and “aub” after
this.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="regex.html#cb238-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>Report <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="regex.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_detect</span>(<span class="at">pattern =</span> <span class="st">&quot;[Rr]aub&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="regex.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb238-4"><a href="regex.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 932</span></span></code></pre></div>
<p>If we also want to detect terms like “Räuber” or “räuberisch”, we have to allow
for an “ä” instead of the “a” as the second character.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="regex.html#cb239-1" aria-hidden="true" tabindex="-1"></a>reports<span class="sc">$</span>Report <span class="sc">%&gt;%</span> </span>
<span id="cb239-2"><a href="regex.html#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_detect</span>(<span class="at">pattern =</span> <span class="st">&quot;[rR][aä]ub&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb239-3"><a href="regex.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb239-4"><a href="regex.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1214</span></span></code></pre></div>
<p>Let us have a look at some of the strings which returned a <code>TRUE</code> match, using
<code>str_detect()</code> in subsetting; telling R we want to see only lines from <code>reports</code>
for which the pattern could be found, and only the first <span class="math inline">\(10\)</span> of these.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="regex.html#cb240-1" aria-hidden="true" tabindex="-1"></a>reports[<span class="fu">str_detect</span>(reports<span class="sc">$</span>Report, <span class="at">pattern =</span> <span class="st">&quot;[Rr][aä]ub&quot;</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb240-2"><a href="regex.html#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb240-3"><a href="regex.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 10 x 3</span></span>
<span id="cb240-4"><a href="regex.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    Date          Report                                   District              </span></span>
<span id="cb240-5"><a href="regex.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;         &lt;chr&gt;                                    &lt;chr&gt;                 </span></span>
<span id="cb240-6"><a href="regex.html#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 18.06.2021 1… &quot;Raub im Hausflur&quot;                       Ereignisort: Charlott…</span></span>
<span id="cb240-7"><a href="regex.html#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 18.06.2021 1… &quot;Mit dem Rettungshubschrauber ins Krank… Ereignisort: Spandau  </span></span>
<span id="cb240-8"><a href="regex.html#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 12.06.2021 1… &quot;Drei Raubüberfälle in 30 Minuten - Tat… Ereignisort: Charlott…</span></span>
<span id="cb240-9"><a href="regex.html#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 09.06.2021 1… &quot;Öffentlichkeitsfahndung nach schwerem … Ereignisort: Mitte    </span></span>
<span id="cb240-10"><a href="regex.html#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 05.06.2021 1… &quot;Supermarkt überfallen und beraubt - An… Ereignisort: Pankow   </span></span>
<span id="cb240-11"><a href="regex.html#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 30.05.2021 1… &quot;Mann geschlagen, getreten und beraubt&quot;  Ereignisort: Mitte    </span></span>
<span id="cb240-12"><a href="regex.html#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 28.05.2021 0… &quot;Jugendlicher Räuber mit Besen vertrieb… Ereignisort: Tempelho…</span></span>
<span id="cb240-13"><a href="regex.html#cb240-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 27.05.2021 1… &quot;Nach Raubüberfall auf Geldboten – zwei… Ereignisort: Neukölln </span></span>
<span id="cb240-14"><a href="regex.html#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 07.05.2021 1… &quot;Goldring geraubt - Festnahme&quot;           Ereignisort: Spandau  </span></span>
<span id="cb240-15"><a href="regex.html#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 05.05.2021 1… &quot;Ladenbesitzer bei Raubüberfall mit Mes… Ereignisort: Mitte</span></span></code></pre></div>
<p>This looks good at first sight, but why was the second report included? Because
“Rettungshubschrauber” also has “raub” in it. You notice, how reliably detecting
a simple string as “raub” gets complicated very quickly.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="regex.html#cb241-1" aria-hidden="true" tabindex="-1"></a>reports[<span class="fu">str_detect</span>(reports<span class="sc">$</span>Report, <span class="at">pattern =</span> <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">s|ge|be|zu)[Rr][aä]ub&quot;</span>), ] <span class="sc">%&gt;%</span> </span>
<span id="cb241-2"><a href="regex.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb241-3"><a href="regex.html#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 10 x 3</span></span>
<span id="cb241-4"><a href="regex.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    Date          Report                                  District               </span></span>
<span id="cb241-5"><a href="regex.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;         &lt;chr&gt;                                   &lt;chr&gt;                  </span></span>
<span id="cb241-6"><a href="regex.html#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 12.06.2021 1… Drei Raubüberfälle in 30 Minuten - Tat… Ereignisort: Charlotte…</span></span>
<span id="cb241-7"><a href="regex.html#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 09.06.2021 1… Öffentlichkeitsfahndung nach schwerem … Ereignisort: Mitte     </span></span>
<span id="cb241-8"><a href="regex.html#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 05.06.2021 1… Supermarkt überfallen und beraubt - An… Ereignisort: Pankow    </span></span>
<span id="cb241-9"><a href="regex.html#cb241-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 30.05.2021 1… Mann geschlagen, getreten und beraubt   Ereignisort: Mitte     </span></span>
<span id="cb241-10"><a href="regex.html#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 28.05.2021 0… Jugendlicher Räuber mit Besen vertrieb… Ereignisort: Tempelhof…</span></span>
<span id="cb241-11"><a href="regex.html#cb241-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 27.05.2021 1… Nach Raubüberfall auf Geldboten – zwei… Ereignisort: Neukölln  </span></span>
<span id="cb241-12"><a href="regex.html#cb241-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 07.05.2021 1… Goldring geraubt - Festnahme            Ereignisort: Spandau   </span></span>
<span id="cb241-13"><a href="regex.html#cb241-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 05.05.2021 1… Ladenbesitzer bei Raubüberfall mit Mes… Ereignisort: Mitte     </span></span>
<span id="cb241-14"><a href="regex.html#cb241-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 04.05.2021 1… Ausgeraubt und fremdenfeindlich beleid… Ereignisort: Treptow-K…</span></span>
<span id="cb241-15"><a href="regex.html#cb241-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 02.05.2021 1… Festnahme nach Raub                     Ereignisort: Charlotte…</span></span></code></pre></div>
<ul>
<li><p>Quantifiers</p></li>
<li><p>or</p></li>
<li><p>Anchors</p></li>
</ul>
</div>
<div id="parsing-two-numbers-from-a-string" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Parsing two numbers from a string</h2>
<ul>
<li>str_extract()</li>
</ul>
<p>numero_parso &lt;- function(x) {
n1 &lt;- parse_number(x, locale = locale(decimal_mark = “,”))
n2 &lt;- str_extract_all(x, “[:digit:]{1,2},{0,1}[:digit:]{0,2}\s{0,1}%”) %&gt;%
unlist() %&gt;%
parse_number(locale = locale(decimal_mark = “,”))
n2 &lt;- n2[1] + n2[2] ## macht dies einmal und trägt Wert in alle else-Fälle ein
## n2 &lt;- sum(n2) summiert ganzen nachträglichen Vektor</p>
<pre><code>ifelse(!(grepl(&quot;.+%.+%&quot;, x)), n1, n2)</code></pre>
<p>}</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplot.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/webscraping-tures/webscraping-tures.github.io/13-regex.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
